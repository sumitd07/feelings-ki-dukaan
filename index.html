<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Feelings Ki Dukaan</title>

 <!-- Favicon -->
  <link rel="icon" type="image/png" href="favicon.png">

  <!-- Import Poppins and Quicksand fonts from Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@600&family=Quicksand:wght@400;600&display=swap" rel="stylesheet">

  <style>

/* General Page Styles */
body {
  font-family: 'Quicksand', sans-serif;
  background: linear-gradient(135deg, #f1e7fe, #ffe1e1); /* Gradient background for entire page */
  text-align: center;
  margin: 0;
  padding: 0;
  color: #333;
  height: 100vh;
}

h1 {
  margin-top: 20px;
  color: #9f5afd;
  font-family: 'Poppins', sans-serif;
  font-size: 48px;
  font-weight: 600;
}

.container {
  margin: 30px auto; /* Reduced margin */
  padding: 20px;
  max-width: 600px;
  background-color: #fff;
  border-radius: 20px;
  box-shadow: 0 12px 24px rgba(0, 0, 0, 0.15);
}

/* First section: Genre selection */
.genre-selection {
  max-height: 300px; /* Limit the height of the chips container */
  overflow-y: auto;  /* Make the container scrollable if the content exceeds */
  padding: 20px;
  margin-bottom: 20px; /* Reduced margin */
  border-radius: 10px;
}

/* Adjust spacing for the chips and button */
label {
  font-size: 24px;
  font-weight: 600;
  color: #9f5afd;
  font-family: 'Poppins', sans-serif;
  margin-bottom: 10px;
  display: block;
}

.chips-container {
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
  margin: 10px 0; /* Less margin to avoid extra spacing */
}

.chip {
  background-color: #e0e0e0;
  border-radius: 25px;
  padding: 10px 20px;
  margin: 8px;
  font-size: 16px;
  font-family: 'Quicksand', sans-serif;
  color: #333;
  cursor: pointer;
  transition: background-color 0.3s ease, transform 0.2s ease;
}

.chip:hover {
  background-color: #ff6f61; /* Coral hover color */
  color: white;
  transform: scale(1.1);
}

.chip.selected {
  background-color: #9f5afd;
  color: white;
}

/* Place the Surprise Me button outside the scrollable chips container */
.surprise-me-container {
  margin-top: 20px; /* Space between the chips and the button */
}

button {
  font-size: 20px;
  padding: 14px;
  margin: 0 auto; /* Center align the button */
  border-radius: 10px;
  border: none;
  width: 100%;
  max-width: 250px;
  display: block;
  background-color: #9f5afd;
  color: white;
  cursor: pointer;
  transition: background-color 0.3s ease, box-shadow 0.3s ease;
  box-shadow: 0 6px 12px rgba(159, 90, 253, 0.4);
}

button:hover {
  background-color: #7e49d3;
  box-shadow: 0 8px 16px rgba(159, 90, 253, 0.6);
}

/* Second section: Video and results */
.video-section {
  margin-top: 50px;
}

.result {
  font-size: 20px;
  color: #333;
  font-family: 'Quicksand', sans-serif;
  margin-bottom: 20px;
}

.result a {
  color: #007bff;
  text-decoration: none;
}

.result a:hover {
  text-decoration: underline;
}

.videoWrapper {
  position: relative;
  padding-bottom: 56.25%;
  height: 0;
  overflow: hidden;
  margin-top: 30px;
}

iframe {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  border: none;
}

#errorMsg {
  color: red;
  margin-top: 10px;
}

/* Welcome Screen Styles */
.welcome-screen {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  background-color: #fff;
  padding: 40px;
  border-radius: 20px;
  text-align: center;
  box-shadow: 0 12px 24px rgba(0, 0, 0, 0.15);
  opacity: 1;
  visibility: visible;
  transition: opacity 1s ease, visibility 0s linear 1s;
  z-index: 999;
  font-family: 'Quicksand', sans-serif;
}

.welcome-screen h2 {
  color: #9f5afd;
  font-family: 'Poppins', sans-serif;
  font-size: 36px;
  font-weight: 600;
  margin-bottom: 10px;
}

.welcome-screen p {
  font-size: 18px;
  font-family: 'Quicksand', sans-serif;
  color: #333;
  margin-bottom: 20px;
}

.welcome-screen.fade-out {
  opacity: 0;
  visibility: hidden;
}

.hidden {
  display: none;
}

/* Mobile Responsiveness */
@media (max-width: 600px) {
  h1 {
    font-size: 36px;
  }
  .container {
    padding: 20px;
    margin: 20px auto;
  }
  .chip {
    padding: 10px 20px;
    font-size: 14px;
  }
  button {
    font-size: 16px;
    padding: 12px;
    margin: 20px auto;
    max-width: 200px;
  }
  .welcome-screen {
    width: 90%;
    padding: 20px;
  }
  .welcome-screen h2 {
    font-size: 28px;
  }
  .welcome-screen p {
    font-size: 16px;
  }
}


  </style>
</head>
<body>

<h1 class="hidden">Feelings Ki Dukaan</h1>

  <!-- Welcome Screen -->
  <div id="welcomeMessage" class="welcome-screen">
    <h2>Welcome to Feelings Ki Dukaan!</h2>
    <p>Your personal mood-based music curator. Let‚Äôs find the perfect song to match your vibe.</p>
  </div>

  <!-- Main Content - Initially Hidden -->
  <div class="container hidden">
    
 

<div class="genre-selection">
    <label for="genre">How are you feeling today?</label>
    <div class="chips-container" id="chipsContainer"></div>
  </div>

  <!-- New container for the Surprise Me button -->
  <div class="surprise-me-container">
    <button id="surpriseMe" style="display: none;">Surprise Me</button>
  </div>

  <!-- Second section: Video and results -->
  <div class="video-section">
    <div class="result" id="result"></div>
    <div class="videoWrapper">
      <iframe id="videoFrame" src="" allowfullscreen></iframe>
    </div>
    <div id="errorMsg"></div>
  </div>

  </div>



  </div>

  <script>
    let songs = [];
    let selectedGenre = null;

    // Fetch records from a single Airtable table
    async function fetchSongsFromTable(tableName) {
        const url = `https://api.airtable.com/v0/appWwK91Mdt6tB6XN/${tableName}?maxRecords=100&view=Grid%20view`;

        try {
            const response = await fetch(url, {
                headers: {
                    'Authorization': 'Bearer patNqRYMw6EhMvx94.931a664f1e79b30730ac5a9f83b2ead4515d0b49681ff8c11c35a36ea84c63ab'
                }
            });

            const data = await response.json();
            if (data.records) {
                parseAirtableData(data.records); // Add records from this table to the songs array
            } else {
                console.error(`No records found in table: ${tableName}`);
            }
        } catch (error) {
            console.error(`Error fetching data from table: ${tableName}`, error);
        }
    }

    // Parse Airtable data and add it to the songs array
    function parseAirtableData(records) {
        records.forEach(record => {
            const song = {
                name: record.fields['songs'],  // Adjust based on your Airtable field names
                genre: record.fields['genre'],
                videoID: record.fields['videoID'] // Adjust based on Airtable fields
            };
            songs.push(song);
        });
    }

    // Fetch records from multiple tables
    async function fetchAllSongs() {
        const tables = ['NEW', 'NEW copy']; // Add the names of your tables here

        for (let tableName of tables) {
            await fetchSongsFromTable(tableName); // Fetch data from each table one by one
        }

        // Once all records are fetched, populate the genres
        populateGenres();
    }

    // Populate the genres as chips (buttons)
    function populateGenres() {
        const genres = [...new Set(songs.map(song => song.genre))]; // Get unique genres
        const chipsContainer = document.getElementById('chipsContainer');

        genres.forEach(genre => {
            const chip = document.createElement('div');
            chip.classList.add('chip');
            chip.textContent = genre;
            chip.addEventListener('click', () => {
                selectGenre(genre);
            });
            chipsContainer.appendChild(chip);
        });
    }

    // Function to handle genre selection
    function selectGenre(genre) {
        selectedGenre = genre;

        const allChips = document.querySelectorAll('.chip');
        allChips.forEach(chip => {
            chip.classList.remove('selected');
        });

        // Highlight selected chip
        const selectedChip = Array.from(allChips).find(chip => chip.textContent === genre);
        selectedChip.classList.add('selected');

        // Show the Surprise Me button after selecting a genre
        document.getElementById('surpriseMe').style.display = 'block';
    }

    // Get a random song from the selected genre
    function getRandomSong() {
        const filteredSongs = songs.filter(song => song.genre === selectedGenre);
        const randomIndex = Math.floor(Math.random() * filteredSongs.length);
        return filteredSongs[randomIndex];
    }

    // Event listener for the "Surprise Me" button
    document.getElementById('surpriseMe').addEventListener('click', function() {
        if (!selectedGenre) return;
        const song = getRandomSong();

        const videoID = song.videoID;
        const videoFrame = document.getElementById('videoFrame');
        const errorMsg = document.getElementById('errorMsg');

        // Embed the YouTube video
    videoFrame.src = `https://www.youtube.com/embed/${videoID}?autoplay=1`;

        // Add hyperlink to the song title
        document.getElementById('result').innerHTML = `Now playing: <a href="https://www.youtube.com/watch?v=${videoID}" target="_blank">${song.name}</a>`;

        // If the video cannot be embedded, show error message with a link to YouTube
        videoFrame.onerror = function() {
            errorMsg.innerHTML = 'Sorry, this video cannot be embedded. <a href="https://www.youtube.com/watch?v=' + videoID + '" target="_blank">Click here to watch it on YouTube</a>.';
        };

        // Reset the error message if the video works
        errorMsg.innerHTML = '';
    });

document.addEventListener('DOMContentLoaded', function() {
    const welcomeMessage = document.getElementById('welcomeMessage');
    const mainContent = document.querySelector('.container');
    const header = document.querySelector('h1'); // Select the header
    const footer = document.querySelector('footer'); // Select the footer

    // Show the welcome message for 3 seconds, then fade out
    setTimeout(function() {
        welcomeMessage.classList.add('fade-out'); // Add fade-out class

        // After the fade-out transition completes (1 second), hide the welcome message completely
        setTimeout(function() {
            welcomeMessage.classList.add('hidden'); // Hide the welcome message completely

            // Show the main content, header, and footer
            mainContent.classList.remove('hidden');
            header.classList.remove('hidden');
            footer.classList.remove('hidden');
        }, 1000); // 1 second for fade-out transition
    }, 5000); // Display welcome message for 5 seconds
});
    // Call this function to fetch all songs across multiple tables
    fetchAllSongs();

  </script>

<!-- Add this code just before the closing </body> tag in your HTML -->
<footer class="hidden">
  Original concept by ShibziüíÉ <br>
  Made with ‚ù§Ô∏è for Shibzi by Mitsu
</footer>


</body>
</html>